<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PsySymbol — Dream Meanings, Symbols & Numbers</title>
  <meta name="description" content="Type a dream, symbol, or number and get an instant interpretation. AI‑assisted, with optional web enrichment." />
  <link rel="canonical" href="https://psysymbol.com/" />
  <meta name="robots" content="index,follow" />

  <meta name="google-adsense-account" content="ca-pub-3857946786580406" />

  <script>
    window.__PSY_ADS__ = {
      client: 'ca-pub-3857946786580406',
      load(params) {
        if (document.getElementById('adsbygooglejs')) return;
        const s = document.createElement('script');
        s.async = true;
        s.id = 'adsbygooglejs';
        let src = `https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${encodeURIComponent(this.client)}`;
        if (params && params.npa === 1) src += '&npa=1';
        s.crossOrigin = 'anonymous';
        s.src = src;
        document.head.appendChild(s);
      }
    };
  </script>

  <script>
    (function() {
      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      window.gtag = gtag;
      gtag('consent', 'default', {
        'ad_storage': 'denied',
        'analytics_storage': 'denied',
        'ad_personalization': 'denied',
        'ad_user_data': 'denied'
      });
      gtag('set', 'url_passthrough', true);
    })();
  </script>

  <style>
    :root{
      --bg:#0b0b0e; --text:#f7f7f7; --muted:#b7b7c0; --card:#14141a; --border:#272732; --brand:#9c7bff; --accent:#24d5a1;
      --dream:#7dd3fc; --symbol:#c4b5fd; --number:#6ee7b7;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;background:var(--bg);color:var(--text);transition:background 300ms ease}
    .container{max-width:980px;margin:0 auto;padding:24px}
    .header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:10px;cursor:pointer;text-decoration:none;color:var(--text)}
    .brand .logo{width:34px;height:34px;border-radius:8px;background:linear-gradient(135deg,var(--brand),var(--accent));display:grid;place-items:center;font-weight:700}
    .brand span{font-weight:700;letter-spacing:.2px}
    nav a{color:var(--muted);text-decoration:none;margin-left:14px;font-size:14px}
    nav a:hover{color:var(--text)}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .tabs{display:flex;gap:8px;margin-bottom:10px}
    .tab{padding:8px 12px;border:1px solid var(--border);border-radius:999px;background:#0f0f14;color:var(--muted);cursor:pointer;transition:transform .15s ease, background .2s ease}
    .tab:hover{transform:translateY(-1px)}
    .tab.active{color:#0b0b0e;background:var(--accent);border-color:transparent;font-weight:600}
    .controls{display:flex;gap:8px;align-items:center;margin-top:8px;flex-wrap:wrap}
    .input{flex:1;min-width:220px;background:#0f0f14;border:1px solid var(--border);border-radius:10px;padding:12px;color:var(--text)}
    .btn{background:var(--brand);border:none;color:#0b0b0e;font-weight:700;padding:12px 14px;border-radius:10px;cursor:pointer;transition:transform .1s ease}
    .btn:active{transform:translateY(1px)}
    .btn.secondary{background:#1a1a22;color:var(--text);border:1px solid var(--border)}
    .muted{color:var(--muted);font-size:13px}
    .output{white-space:pre-wrap;line-height:1.6}
    .hr{height:1px;background:var(--border);margin:16px 0}
    .tip{margin-top:10px; font-size:12px; opacity:.85}

    .reveal{animation:reveal .28s ease-out both}
    @keyframes reveal{ from{opacity:0; transform:translateY(4px)} to{opacity:1; transform:translateY(0)} }

    body[data-theme="dream"] .tab[data-mode="dream"].active{ background:var(--dream); }
    body[data-theme="symbol"] .tab[data-mode="symbol"].active{ background:var(--symbol); }
    body[data-theme="number"] .tab[data-mode="number"].active{ background:var(--number); }

    footer{margin-top:32px;color:var(--muted)}
    .footer-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .footer-grid a{color:var(--muted);text-decoration:none}
    .footer-grid a:hover{color:var(--text)}

    dialog.legal{max-width:820px;width:100%;background:var(--card);color:var(--text);border:1px solid var(--border);border-radius:14px;padding:18px}
    dialog::backdrop{background:rgba(0,0,0,.6)}

    .cookie{position:fixed;inset:auto 12px 12px 12px;background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;display:none;z-index:50}
    .cookie.show{display:block}
    .cookie .actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end;margin-top:10px}

    @media (max-width:640px){ .footer-grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <header class="container header">
    <a class="brand" id="brandHome" title="Reset to start">
      <div class="logo">Ψ</div>
      <span>PsySymbol</span>
    </a>
    <nav>
      <a href="#about" id="aboutLink">About</a>
      <a href="#contact" id="contactLink">Contact</a>
      <a href="#privacy" id="privacyLink">Privacy</a>
      <a href="#terms" id="termsLink">Terms</a>
    </nav>
  </header>

  <main class="container">
    <section class="card">
      <div class="tabs">
        <button class="tab active" data-mode="dream">Dream</button>
        <button class="tab" data-mode="symbol">Symbol</button>
        <button class="tab" data-mode="number">Number</button>
      </div>
      <div class="row">
        <input id="query" class="input" placeholder="Type your dream, symbol, or number…" />
        <button id="interpret" class="btn">Interpret</button>
        <button id="reset" class="btn secondary">Reset</button>
      </div>
      <div class="controls">
        <label class="muted"><input type="checkbox" id="enrichToggle" checked /> Enrich with web sources (beta)</label>
      </div>
      <div class="hr"></div>
      <div id="result" class="output muted">Enter something above and press <b>Interpret</b>.</div>
    </section>

    <footer>
      <div class="footer-grid">
        <div>
          <div class="muted">© <span id="year"></span> PsySymbol. All rights reserved.</div>
        </div>
        <div style="text-align:right">
          <a href="#privacy">Privacy</a> · <a href="#cookie">Cookie Policy</a> · <a href="#terms">Terms</a>
        </div>
      </div>
    </footer>
  </main>

  <!-- LEGAL DIALOGS -->
  <dialog id="dlg-privacy" class="legal">
    <h3>Privacy Policy</h3>
    <p>Last updated: <span id="privacy-date"></span></p>
    <p>PsySymbol processes your inputs client‑side. When “Enrich with web sources (beta)” is enabled, public summaries may be fetched. We do not sell personal data. See Cookie Policy for ad consent details.</p>
    <form method="dialog"><button class="btn secondary">Close</button></form>
  </dialog>

  <dialog id="dlg-cookie" class="legal">
    <h3>Cookie Policy & Consent</h3>
    <p>Choose: personalized ads, non‑personalized ads, or no ads cookies.</p>
    <div class="hr"></div>
    <div class="row">
      <button id="cookieAccept" class="btn">Allow Personalized Ads</button>
      <button id="cookieNPA" class="btn secondary">Allow Non‑Personalized Ads</button>
      <button id="cookieReject" class="btn secondary">Reject Ads Cookies</button>
    </div>
    <p class="muted" style="margin-top:10px">Change anytime from the footer: <a href="#cookie">Cookie Policy</a>.</p>
    <form method="dialog"><button class="btn secondary" style="margin-top:12px">Close</button></form>
  </dialog>

  <dialog id="dlg-terms" class="legal">
    <h3>Terms of Service</h3>
    <p>Interpretations are informational and not medical, legal, or psychological advice. Don’t submit unlawful content. We may update these terms.</p>
    <form method="dialog"><button class="btn secondary">Close</button></form>
  </dialog>

  <dialog id="dlg-about" class="legal">
    <h3>About PsySymbol</h3>
    <p>PsySymbol is a single‑page tool for quick interpretations of dreams, symbols, and numbers—with optional web enrichment. No accounts, no downloads.</p>
    <form method="dialog"><button class="btn secondary">Close</button></form>
  </dialog>

  <dialog id="dlg-contact" class="legal">
    <h3>Contact</h3>
    <p>Questions? Email: <a href="mailto:hello@psysymbol.com">hello@psysymbol.com</a></p>
    <form method="dialog"><button class="btn secondary">Close</button></form>
  </dialog>

  <div id="cookieBanner" class="cookie" role="dialog" aria-live="polite">
    <div><b>Ad choices:</b> Personalized, Non‑personalized, or No ads cookies.
      <div class="actions">
        <button id="bannerReject" class="btn secondary">No Ads Cookies</button>
        <button id="bannerNPA" class="btn secondary">Non‑Personalized Ads</button>
        <button id="bannerAccept" class="btn">Personalized Ads</button>
      </div>
    </div>
  </div>

  <script>
    // Enhancements only — core functions remain untouched.

    const $ = sel => document.querySelector(sel);
    const tabs = document.querySelectorAll('.tab');
    const query = $('#query');
    const result = $('#result');
    const enrichToggle = $('#enrichToggle');

    // Mode-based theme without editing setMode()
    function applyThemeFromActiveTab(){
      const active = document.querySelector('.tab.active');
      const theme = active ? active.dataset.mode : 'dream';
      document.body.setAttribute('data-theme', theme);
    }
    applyThemeFromActiveTab();
    tabs.forEach(t=> t.addEventListener('click', applyThemeFromActiveTab));

    // Inspirational tip
    const tipEl = document.createElement('div');
    tipEl.id = 'psy-tip';
    tipEl.className = 'tip muted';
    document.querySelector('.hr').insertAdjacentElement('afterend', tipEl);
    const TIPS = [
      'Notice the strongest feeling—meaning often sits behind emotion.',
      'Context matters: who, where, and when shape the symbol.',
      'Tiny steps beat perfect plans. Pick one next action.',
      'If a theme repeats this week, give it a name. Naming gives you leverage.',
      'Ask: what is this helping me protect or pursue?'
    ];
    function setRandomTip(){ tipEl.textContent = TIPS[Math.floor(Math.random()*TIPS.length)]; }
    setRandomTip();

    // Animate results + store cache
    const obs = new MutationObserver(()=>{
      result.classList.remove('reveal');
      void result.offsetWidth;
      result.classList.add('reveal');
      setRandomTip();
      saveCache();
    });
    obs.observe(result, { childList: true, characterData: true, subtree: true });

    // LocalStorage cache for quick recall
    const CACHE_KEY = 'psysymbol-last';
    function keyFor(modeText, q){ return `${modeText}::${q.trim().toLowerCase()}`; }
    function saveCache(){
      const active = document.querySelector('.tab.active');
      const modeText = active ? active.dataset.mode : 'dream';
      const q = query.value || '';
      const payload = { k: keyFor(modeText,q), v: result.textContent, t: Date.now() };
      try { localStorage.setItem(CACHE_KEY, JSON.stringify(payload)); } catch {}
    }
    function tryRestoreFromCache(){
      try{
        const s = localStorage.getItem(CACHE_KEY);
        if(!s) return;
        const {k, v} = JSON.parse(s);
        const active = document.querySelector('.tab.active');
        const modeText = active ? active.dataset.mode : 'dream';
        const currentKey = keyFor(modeText, query.value||'');
        if(k === currentKey && v){
          result.textContent = v;
        }
      }catch{}
    }
    query.addEventListener('input', ()=>{
      clearTimeout(window.__psyd_);
      window.__psyd_ = setTimeout(tryRestoreFromCache, 120);
      prefetchEnrichment(query.value);
    });

    // Prefetch enrichment via Cache API (assist browser caching)
    async function prefetchEnrichment(q){
      if(!enrichToggle.checked) return;
      const active = document.querySelector('.tab.active');
      const t = active ? active.dataset.mode : 'dream';
      if(!q || !q.trim()) return;
      let url = null;
      if(t === 'number'){
        url = `https://numbersapi.com/${encodeURIComponent(q.trim())}/trivia`;
      } else {
        url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(q.trim())}`;
      }
      try{
        const cache = await caches.open('psysymbol-prefetch-v1');
        const req = new Request(url, { mode:'cors' });
        const res = await fetch(req);
        if(res && res.ok){ cache.put(req, res.clone()); }
      }catch{}
    }

    // Consent boilerplate (unchanged behavior)
    const CONSENT_KEY='psysymbol-consent-v2';
    function getConsent(){ try{ return JSON.parse(localStorage.getItem(CONSENT_KEY)||'null'); }catch{return null} }
    function setConsent(val){ localStorage.setItem(CONSENT_KEY, JSON.stringify({ val, ts: Date.now() })); }
    function applyConsent(modeChoice){
      if(modeChoice==='personalized'){
        gtag('consent','update',{'ad_storage':'granted','ad_personalization':'granted','ad_user_data':'granted','analytics_storage':'denied'});
        window.__PSY_ADS__.load({npa:0});
      } else if(modeChoice==='npa'){
        gtag('consent','update',{'ad_storage':'granted','ad_personalization':'denied','ad_user_data':'denied','analytics_storage':'denied'});
        window.__PSY_ADS__.load({npa:1});
      } else {
        gtag('consent','update',{'ad_storage':'denied','ad_personalization':'denied','ad_user_data':'denied','analytics_storage':'denied'});
      }
    }
    function acceptPersonalized(){ setConsent('personalized'); $('#cookieBanner').classList.remove('show'); applyConsent('personalized'); }
    function acceptNPA(){ setConsent('npa'); $('#cookieBanner').classList.remove('show'); applyConsent('npa'); }
    function rejectAds(){ setConsent('rejected'); $('#cookieBanner').classList.remove('show'); applyConsent('rejected'); }
    document.getElementById('bannerAccept').addEventListener('click', acceptPersonalized);
    document.getElementById('bannerNPA').addEventListener('click', acceptNPA);
    document.getElementById('bannerReject').addEventListener('click', rejectAds);
    document.getElementById('cookieAccept').addEventListener('click', acceptPersonalized);
    document.getElementById('cookieNPA').addEventListener('click', acceptNPA);
    document.getElementById('cookieReject').addEventListener('click', rejectAds);

    document.getElementById('year').textContent = new Date().getFullYear();
    document.getElementById('privacy-date').textContent = new Date().toLocaleDateString();
    const saved = getConsent();
    if(!saved){ document.getElementById('cookieBanner').classList.add('show'); }
  </script>
</body>
</html>
