<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PsySymbol — Dream Meanings & Symbolism</title>
  <meta name="description" content="AI-generated interpretations for dreams, symbols, and numbers — now enriched with real-world sources." />
  <link rel="canonical" href="https://psysymbol.com/" />
  <meta name="robots" content="index,follow" />

  <!-- AdSense -->
  <meta name="google-adsense-account" content="ca-pub-3857946786580406" />
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  <style>
    :root{
      --bg:#0b0b0e;--text:#f7f7f7;--muted:#b7b7c0;--card:#14141a;--border:#272732;
      --accent:#b991ff;--accent2:#8fd4ff;
    }
    *{box-sizing:border-box;font-family:system-ui,Segoe UI,Roboto,Ubuntu}
    body{margin:0;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:24px}
    header{display:flex;align-items:center;justify-content:center;gap:8px;margin-bottom:20px;cursor:pointer}
    header h1{font-size:1.6rem;letter-spacing:0.04em}
    #mode{font-weight:600;margin-left:4px;color:var(--accent)}
    #controls{display:flex;align-items:center;gap:12px;margin-bottom:12px;flex-wrap:wrap;justify-content:center}
    input[type=text]{padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:var(--card);color:var(--text);width:260px}
    button{cursor:pointer;border:none;background:var(--accent);color:#fff;font-weight:600;padding:10px 18px;border-radius:12px;transition:.2s}
    button:hover{background:var(--accent2);color:#000}
    #output{max-width:700px;margin-top:12px;text-align:left}
    .meaning{background:var(--card);padding:18px;border-radius:14px;border:1px solid var(--border)}
    .meaning h2{margin-top:0;font-size:1.2rem;color:var(--accent2)}
    .aggCard a{color:var(--accent2)}
    @media(max-width:600px){input[type=text]{width:100%}}
  </style>
</head>

<body>
  <header id="logo"><h1>Ψ <span id="mode">Dream</span></h1></header>

  <div id="controls">
    <input id="query" type="text" placeholder="Type a dream, symbol, or number…" />
    <button id="interpret" data-action="interpret">Interpret</button>
    <label><input type="checkbox" id="enrich" checked /> Enrich with web sources (β)</label>
  </div>

  <div id="output"></div>

  <!-- Core logic -->
  <script>
    let currentMode = 'Dream';
    const modeEl = document.getElementById('mode');
    const queryEl = document.getElementById('query');
    const outputEl = document.getElementById('output');
    const logo = document.getElementById('logo');

    logo.onclick = () => {
      const order = ['Dream','Symbol','Number'];
      currentMode = order[(order.indexOf(currentMode)+1)%order.length];
      modeEl.textContent = currentMode;
      queryEl.value='';outputEl.innerHTML='';
    };

    function interpretCore(input){
      const q = input.trim().toLowerCase();
      if(!q) return 'Type something first.';
      if(currentMode==='Number') return `The number ${q} may symbolize ${q.length%2?'individuality':'balance'} and ${q.includes('7')?'spiritual insight':'worldly experience'}.`;
      if(currentMode==='Symbol') return `${q.charAt(0).toUpperCase()+q.slice(1)} often represents ${q.length>6?'complex emotions or transformation':'simplicity or clarity'}.`;
      return `Dreaming of ${q} may reflect ${q.includes('water')?'emotional flow':'personal energy'} and subconscious ${q.includes('animal')?'instincts':'patterns'}.`;
    }

    document.getElementById('interpret').onclick = () => {
      const q = queryEl.value.trim();
      const meaning = interpretCore(q);
      outputEl.innerHTML = `<div class="meaning"><h2>${currentMode} Interpretation</h2><p>${meaning}</p></div>`;
      if(document.getElementById('enrich').checked) runAggregator(q,currentMode).then(renderAggregator);
    };
  </script>

  <!-- Aggregator logic -->
  <script>
  const SourceAdapters = {
    wikipedia: async (q,sig)=>{const r=await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(q)}`,{signal:sig});if(!r.ok)return[];const j=await r.json();return j.extract?[{source:'Wikipedia',title:j.title||q,snippet:j.extract,url:j.content_urls?.desktop?.page,confidence:.9}]:[]},
    duckduckgo: async (q,sig)=>{const r=await fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(q)}&format=json&no_html=1&skip_disambig=1`,{signal:sig});if(!r.ok)return[];const j=await r.json();const out=[];if(j.AbstractText)out.push({source:'DuckDuckGo',title:j.Heading||q,snippet:j.AbstractText,url:j.AbstractURL,confidence:.7});(j.RelatedTopics||[]).slice(0,3).forEach(t=>{if(t.Text)out.push({source:'DuckDuckGo',title:t.Text.split(' - ')[0],snippet:t.Text,url:t.FirstURL,confidence:.5})});return out},
    wiktionary: async (q,sig)=>{const r=await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(q)}`,{signal:sig});if(!r.ok)return[];const j=await r.json();if(!Array.isArray(j))return[];const defs=[];j.forEach(e=>(e.meanings||[]).forEach(m=>(m.definitions||[]).slice(0,2).forEach(d=>defs.push({source:'Wiktionary',title:`${e.word} — ${m.partOfSpeech||''}`.trim(),snippet:d.definition,url:`https://en.wiktionary.org/wiki/${encodeURIComponent(e.word)}`,confidence:.6}))));return defs.slice(0,4)},
    numbers: async (q,sig)=>{if(!/^\d+$/.test(String(q).trim()))return[];const r=await fetch(`https://numbersapi.com/${encodeURIComponent(q)}/trivia`,{signal:sig});if(!r.ok)return[];const t=await r.text();return[{source:'Numbers API',title:`Number ${q}`,snippet:t,url:`http://numbersapi.com/${encodeURIComponent(q)}`,confidence:.8}]}
  };
  let aggState={enabled:true,use:{wikipedia:true,duckduckgo:true,wiktionary:true,numbers:true}};
  let currentController=null;
  function normalizeAndRank(items,mode,q){const seen=new Set();const out=[];for(const it of items){const key=(it.url||'')+'|'+(it.title||'');if(seen.has(key))continue;seen.add(key);let s=it.confidence||.5;if(mode==='Number'&&it.source.includes('Number'))s+=.2;if((it.title||'').toLowerCase().includes(q.toLowerCase()))s+=.05;out.push({...it,score:s})}return out.sort((a,b)=>b.score-a.score).slice(0,12)}
  async function runAggregator(q,mode){if(!aggState.enabled||!q)return[];if(currentController)currentController.abort();currentController=new AbortController();const sig=currentController.signal;const keys=Object.keys(SourceAdapters).filter(k=>aggState.use[k]);const all=await Promise.all(keys.map(k=>SourceAdapters[k](q,sig).catch(()=>[])));return normalizeAndRank(all.flat(),mode,q)}
  function renderAggregator(results){let box=document.getElementById('aggResults');if(!box){box=document.createElement('section');box.id='aggResults';box.innerHTML='<h3 style="margin:16px 0 8px">Sources</h3>';outputEl.appendChild(box);}box.querySelectorAll('.aggCard').forEach(n=>n.remove());results.forEach(r=>{const card=document.createElement('article');card.className='aggCard';card.style.border='1px solid var(--border)';card.style.borderRadius='12px';card.style.padding='12px';card.style.margin='8px 0';card.innerHTML=`<div style="display:flex;justify-content:space-between;gap:12px;align-items:flex-start"><div><div style="font-weight:600">${r.title||r.source}</div><p style="margin:6px 0 0;opacity:.85">${r.snippet||''}</p></div><a href="${r.url||'#'}" target="_blank" rel="noopener">Open →</a></div><div style="margin-top:8px;font-size:12px;opacity:.7">via ${r.source}</div>`;box.appendChild(card);});}
  </script>
</body>
</html>
